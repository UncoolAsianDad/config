# RockFlight RFFC F405 V3 Flight Controller & 60A 4-in-1 ESC Manual

## Introduction
This manual provides detailed instructions for the installation, operation, and maintenance of your RockFlight RFFC F405 V3 Flight Controller and the accompanying 60A 4-in-1 BLheli_S Electronic Speed Controller (ESC). Designed for RC FPV racing drones and quadcopters, this system offers robust performance and versatile connectivity. Please read this manual thoroughly before use to ensure proper setup and safe operation.

## Package Contents
Verify that all items are present in your package:

- RFFC F405 V3 Flight Controller
- 60A 4-in-1 BLheli_S ESC
- Connection Cables (ribbon cables for FC-ESC, DJI Air Unit, etc.)
- Yellow Vibration Dampeners (4 pcs)
- Capacitors
- XT60 Connector
- Power Wires (red and black)

![Included components of the F405 V3 Flight Controller and 4-in-1 ESC kit](image.png)
*Figure 1: Included components of the F405 V3 Flight Controller and 4-in-1 ESC kit.*

## Specifications

| Feature                          | Specification                                                                            |
| :------------------------------- | :--------------------------------------------------------------------------------------- |
| **Product Name**                 | RFFC-F405 Flight Control                                                                 |
| **Main Control Unit**            | STM32F405                                                                                |
| **Gyroscope**                    | ICM42688P                                                                                |
| **USB Interface Type**           | Type-C                                                                                   |
| **Barometer**                    | Built-in (optional)                                                                      |
| **OSD Chip**                     | AT7456E                                                                                  |
| **WiFi Support**                 | Not supported                                                                            |
| **DJI Air Unit Connection**      | 6-pin socket, direct plug, compatible with DJIO3/RunCam Link/Caddx Vista/DJIAir Unit V1  |
| **Black Box**                    | On-board large-capacity Nor flash (optional)                                             |
| **Galvanometer**                 | Supports (Scale=200 Offset=0)                                                            |
| **Input Voltage**                | 3S - 6S Lithium Battery                                                                  |
| **5V BEC Output**                | 9 groups, total 1.5A (1 front +5V pad, 1 BZ+ buzzer pad, 1 external LED light strip pad) |
| **9V BEC Output**                | 3 groups, total 2A (1 +9V pad on front, 2 cells on back)                                 |
| **ESC Signal Line**              | M1-M4 sockets on back, solder joints on front                                            |
| **UART Serial Ports**            | 4 groups (UART1 for GPS, UART3 for receiver, UART4, UART6)                               |
| **BetaFlight Camera Adjustment** | Supports socket (front CC pad)                                                           |
| **Traditional BF LED Pads**      | 5V, G, LED pad for WS2812 LED strip, controlled by BF firmware                           |
| **Buzzer Pad**                   | BZ+ and BZ- pads for 5V passive buzzer                                                   |
| **BOOT Key**                     | For DFU mode (firmware flashing)                                                         |
| **Supported Firmware**           | BetaFlight (default), INAV (Multishot, OneShot125 only, DShot not supported)             |
| **Installation Hole Position**   | 30.5 x 30.5mm (4mm hole diameter)                                                        |
| **Dimensions**                   | 36.0mm (L) x 36.0mm (W) x 7.8mm (H)                                                      |
| **Weight**                       | 8g                                                                                       |
| **Material**                     | Composite Material                                                                       |
| **Vehicle Type**                 | Airplanes, RC FPV Racing Drones, Quadcopters                                             |

## Setup and Installation
Careful installation is crucial for optimal performance. Refer to the diagrams and pin definitions below for correct wiring.

### Flight Controller Pinout Overview

![RFFC F405 V3 Flight Controller Pinout Diagram](layout.png)
*Figure 2: RFFC F405 V3 Flight Controller Pinout Diagram.*

![Detailed connection points on the F405 V3 Flight Controller](layout2.png)
*Figure 3: Detailed connection points on the F405 V3 Flight Controller.*

### Pin Definitions
Refer to the numbered connection points in Figure 3 for the following pin definitions:

#### ① Electronic Speed Control (ESC) Interface (8-pin 1.0mm)
1. **GND**: Ground
2. **VBAT**: Battery Input, 3-6S
3. **M1**: Motor No. 1
4. **M2**: Motor No. 2
5. **M3**: Motor No. 3
6. **M4**: Motor No. 4
7. **CRU**: Galvanometer Input
8. **NC**: Not Connected

#### ② Camera (CAM1) Interface (3-pin 1.0mm)
1. **VCC**: Camera Power Supply Output, 5V
2. **GND**: Ground
3. **AV IN**: Camera Input

#### ③ Camera (CAM2) Interface (3-pin 1.0mm)
1. **VCC**: Camera Power Supply Output, 5V
2. **GND**: Ground
3. **AV IN**: Camera Input

#### ④ GPS Interface (6-pin 1.0mm)
1. **VCC**: 5V Output
2. **GND**: Ground
3. **TX1**: Serial Port 1 Output, connects to GPS module input
4. **RX1**: Serial Port 1 Input, connects to GPS module output
5. **SDA**: External I2C SDA
6. **SCL**: External I2C SCL

#### ⑤ DJI Sky End (DJI-O) Socket (6-pin 1.0mm)
1. **PPM**: PPM Input
2. **GND**: Ground
3. **RX4**: MSP UART4
4. **TX4**: MSP UART4
5. **GND**: Ground
6. **VCC**: 9V Output

#### ⑥ SERVO2 Interface (3-pin 1.0mm)
1. **PWM**: Servo Signal Output, GPIO PB0
2. **GND**: Ground
3. **VCC**: 5V Output

#### ⑦ SERVO1 Interface (3-pin 1.0mm)
1. **PWM**: Servo Signal Output, GPIO PB1
2. **GND**: Ground
3. **VCC**: 5V Output

#### ⑧ Receiver (ELRS) Interface (4-pin 1.0mm)
1. **VCC**: 4.5V Output
2. **GND**: Ground
3. **TX3**: Serial Port 3 Output, connects to receiver input
4. **RX3**: Serial Port 3 Input, connects to receiver output

#### ⑨ VTX MODULE Interface (5-pin 1.0mm)
1. **AV OUT**: Video Signal Output, front solder joint AVO
2. **GND**: Ground
3. **IRC**: Parameter Adjustment Output, front solder joint TX2
4. **GND**: Ground
5. **VCC**: Power Output, same as battery voltage, front solder joint VTX

### Wiring Diagrams

![DJI Sky End and ELRS Receiver Wiring Diagram](wiring.png)
*Figure 4: DJI Sky End and ELRS Receiver Wiring Diagram.*

> [!IMPORTANT]
> **Special Precautions for ELRS Receivers**: If using the DJI Sky End simultaneously with some ELRS receivers, you might encounter issues with the flight controller recognizing the receiver. In such cases, disconnect the SBUS signal line from the DJI Sky End ribbon cable. This can be done by carefully picking out the SBUS wire from the 6-pin ribbon cable terminals or by cutting and insulating the wire ends.

## Operating Instructions

### Firmware
The RFFC F405 V3 Flight Controller comes with BetaFlight firmware as the default factory setting. It also supports INAV firmware, but please note that for INAV, only Multishot (recommended) and OneShot125 protocols are supported. DShot is **NOT** supported with INAV firmware.

> [!NOTE]
> The RFFC-F405 flight control does not support wireless firmware flashing.

### DFU Mode for Firmware Flashing
If you encounter issues or need to flash new firmware, you can force the flight controller into DFU (Device Firmware Upgrade) mode. To do this, press and hold the **BOOT** button while simultaneously powering the flight control system.

### Peripheral Connections
- **LED Light Strip**: Connect WS2812 LED light strips to the 5V, G, and LED pads located at the lower right of the front side. These are controlled by BetaFlight firmware.
- **Buzzer**: Connect a 5V passive buzzer to the BZ+ and BZ- pads.
- **Camera Parameter Adjustment**: Utilize the front CC pad socket for BetaFlight camera parameter adjustments.

## User Tips
- **BetaFlight Target**: When configuring in BetaFlight, the correct target for this flight controller is typically **RFFC-F405**. Ensure you select this target for proper functionality.
- **Power Supply**: Always ensure your lithium battery input is within the **3S-6S** range to prevent damage to the flight controller.

## Troubleshooting
- **ELRS Receiver Not Recognized with DJI Sky End**: If you experience issues with your ELRS receiver not being recognized when the DJI Sky End is also connected, try disconnecting the SBUS signal line from the DJI Sky End ribbon cable. This can resolve compatibility conflicts.
- **Firmware Flashing Issues**: If standard firmware flashing fails, power off the flight controller, then press and hold the BOOT button while reconnecting power to enter DFU mode. This allows for a forced firmware flash.
- **No Wireless Firmware Flashing**: Remember that this flight controller does not support wireless firmware updates. All firmware flashing must be done via a wired USB connection.

## Maintenance
To ensure the longevity and reliable performance of your flight controller and ESC, follow these maintenance guidelines:
- **Keep Clean**: Regularly inspect the boards for dust, dirt, or debris. Use a soft brush or compressed air to gently clean the components. Avoid using liquids directly on the electronics.
- **Inspect Connections**: Periodically check all soldered joints and connector pins for secure connections. Loose connections can lead to intermittent issues or failures.
- **Avoid Physical Damage**: Protect the flight controller and ESC from impacts and excessive vibrations. Ensure they are securely mounted within your drone.
- **Proper Storage**: When not in use, store the components in a dry, anti-static environment, away from extreme temperatures.

## Warranty and Support
For technical support, troubleshooting assistance beyond this manual, or warranty inquiries, please contact your retailer or the manufacturer directly. Keep your proof of purchase for any warranty claims.
